{% extends "layout.html" %}

{% block title %}
    Movie Recommender
{% endblock %}

{% block main %}
<form action="/recommend" method="get">
    <div class="d-flex justify-content-center align-items-center mb-3">
        <input autocomplete="off" autofocus class="form-control w-auto me-2" name="movie" placeholder="Movie title" type="text">
        <button class="btn btn-primary me-2" type="submit">Search</button>
        <form action="/favorites" method="POST" style="display:inline;">
            <button type="submit" class="btn btn-primary">Find based on favorites</button>
        </form>
    </div>
</form>

<script>
    function fetchSuggestions() {
        const query = document.getElementById("movie-search").value;
        if (query.length > 2) {
            fetch(`/search-movie?query=${query}`)
                .then(response => response.json())
                .then(data => {
                    const suggestionsList = document.getElementById("suggestions-list");
                    suggestionsList.innerHTML = '';
                    data.forEach(movie => {
                        const listItem = document.createElement("li");
                        listItem.classList.add("list-group-item");
                        listItem.textContent = movie;
                        listItem.onclick = function() {
                            document.getElementById("movie-search").value = movie;
                            suggestionsList.innerHTML = '';
                        };
                        suggestionsList.appendChild(listItem);
                    });
                });
        } else {
            document.getElementById("suggestions-list").innerHTML = '';
        }
    }
</script>

{% endblock %}